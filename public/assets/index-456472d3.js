import{_ as te}from"./copyright-281a328c.js";import{f as W,r as G,aF as L,e as p,A as a,u as e,v as u,x as n,w as i,C as oe,aG as se,T as le,d,B as O,t as f,h as b,G as k,E as h,Y as ae,R as ne,Q as re,a8 as ie}from"./vendor-8484c245.js";import{u as ce,_ as de}from"./vcode-144749dd.js";import{e as ue,c as me,d as pe,h as ge,$ as v,r as _e}from"./index-a553babf.js";const fe=a("div",{class:"login-bg"},null,-1),he={class:"login-mask"},ve={class:"flex flex-1 flex-center"},xe={key:0,class:"login-image mr-10"},be=["src"],ke={class:"text-center p-5"},ye={class:"flex flex-center pb-4"},Ce={class:"h10 pt-3"},we={class:"flex-1 py-5 w-60 mx-auto flex flex-center flex-column"},Ve={class:"px-3"},Ee=a("div",{class:"p-4 flex flex-center mb-10"},[a("button",{class:"login-button"},"登录")],-1),Be={key:0,class:"py-4 flex flex-center text-info"},Re={key:1,class:"py-4 flex flex-center text-dark"},Ie=a("span",null,"点击“登录”即代表你已阅读并同意",-1),Te={class:"bg-filter bg-mask-light"},Se=W({name:"/login"}),qe=W({...Se,setup(Fe){var V;const{setUserInfo:A}=ue(),Q=me(),{WEBCONFIG:t}=pe(Q),{isDisabled:Y,vcodeText:j,getVcode:H}=ce(),y=G(),s=L({username:"",password:"",vcode:"",token:"",captcha:""}),J=L({username:[{required:!0,message:"请输入账号",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}],captcha:[{required:!0,message:"请输入图形验证码",trigger:"blur"}]}),c=G((V=t.value.login)==null?void 0:V.url),K=()=>{var g;(g=y.value)==null||g.validate(o=>{o?v.post(c.value,s).then(l=>{l.code===v.ResponseCode.SUCCESS?(h.success(l.msg),A(l.data).then(()=>{_e.push("/")}).catch(m=>{h.info(m)})):l.code===v.ResponseCode.REDIRECT_CONFIRM?ae.confirm(l.msg,"提示",{confirmButtonText:l.data.confirmButtonText||"跳转",cancelButtonText:"取消",type:"warning"}).then(()=>{globalThis.location.href=l.data.url}):l.code===v.ResponseCode.REDIRECT?globalThis.location.href=l.data.url:h.info(l.msg)}):h.error("请将表单填写完整")})},P=g=>{s.token=g,s.captcha=""},{BgImage:C,Image:w}=ge();return(g,o)=>{const l=ne,m=re,X=de,x=ie,Z=le,ee=te;return d(),p("div",{class:"login",style:se([e(C)?`backgroundImage:url(${e(C)})`:""])},[fe,a("div",he,[a("div",ve,[e(w)?(d(),p("div",xe,[a("img",{src:e(w),alt:"logo",class:"login-image"},null,8,be)])):u("",!0),n(Z,{ref_key:"loginFormRef",ref:y,model:e(s),rules:e(J),class:"login-form bg-filter","label-position":"top","hide-required-asterisk":"","show-message":!1,onSubmit:oe(K,["prevent"])},{default:i(()=>{var E,B,R,I,T,S,F,U,$,z,N,q,D,M;return[a("div",ke,[a("div",ye,[(E=e(t).login)!=null&&E.enable?(d(),p("div",{key:0,class:O(["h8 font-weight-600 mr-4 pointer nav-item",{active:e(c)===((B=e(t).login)==null?void 0:B.url)}]),onClick:o[0]||(o[0]=r=>{var _;return c.value=(_=e(t).login)==null?void 0:_.url})},f((R=e(t).login)==null?void 0:R.title),3)):u("",!0),(I=e(t).vcode)!=null&&I.enable?(d(),p("div",{key:1,class:O(["h8 font-weight-600 ml-4 pointer nav-item",{active:e(c)===((T=e(t).vcode)==null?void 0:T.url)}]),onClick:o[1]||(o[1]=r=>{var _;return c.value=(_=e(t).vcode)==null?void 0:_.url})},f((S=e(t).vcode)==null?void 0:S.title),3)):u("",!0)]),a("div",Ce,f(e(t).title),1)]),a("div",we,[n(m,{label:"用户名",class:"w-100",prop:"username"},{default:i(()=>[n(l,{modelValue:e(s).username,"onUpdate:modelValue":o[2]||(o[2]=r=>e(s).username=r),placeholder:"手机号/用户名/邮箱",size:"large"},null,8,["modelValue"])]),_:1}),e(c)===((F=e(t).login)==null?void 0:F.url)?(d(),b(m,{key:0,label:"密码",class:"w-100",prop:"password"},{default:i(()=>[n(l,{modelValue:e(s).password,"onUpdate:modelValue":o[3]||(o[3]=r=>e(s).password=r),type:"password",placeholder:"密码",size:"large"},null,8,["modelValue"])]),_:1})):u("",!0),e(c)===((U=e(t).vcode)==null?void 0:U.url)||e(c)===(($=e(t).login)==null?void 0:$.url)&&((z=e(t).login)!=null&&z.captcha)?(d(),b(m,{key:1,label:"图形验证码",class:"w-100",prop:"captcha"},{default:i(()=>[n(l,{modelValue:e(s).captcha,"onUpdate:modelValue":o[4]||(o[4]=r=>e(s).captcha=r),placeholder:"图形验证码",size:"large"},{append:i(()=>[n(X,{onChange:P,bg:"52,52,52"})]),_:1},8,["modelValue"])]),_:1})):u("",!0),e(c)===((N=e(t).vcode)==null?void 0:N.url)?(d(),b(m,{key:2,label:"短信验证码",class:"w-100",prop:"vcode"},{default:i(()=>[n(l,{modelValue:e(s).vcode,"onUpdate:modelValue":o[6]||(o[6]=r=>e(s).vcode=r),placeholder:"短信验证码",size:"large",maxlength:"6"},{append:i(()=>[a("div",Ve,[n(x,{onClick:o[5]||(o[5]=r=>e(H)({mobile:e(s).username,token:e(s).token,scode:e(s).captcha})),type:e(Y)?"info":"primary",target:"_blank",underline:!1,class:"line-height-5"},{default:i(()=>[k(f(e(j)),1)]),_:1},8,["type"])])]),_:1},8,["modelValue"])]),_:1})):u("",!0)]),Ee,(q=e(t).register)!=null&&q.enable?(d(),p("div",Be,[n(x,{href:"#/register",type:"primary",underline:!1},{default:i(()=>[k("还没有账号？点击免费注册")]),_:1})])):u("",!0),(D=e(t).login)!=null&&D.user_agreement?(d(),p("div",Re,[Ie,n(x,{href:(M=e(t).login)==null?void 0:M.user_agreement,type:"primary",target:"_blank",underline:!1},{default:i(()=>[k("《用户协议》")]),_:1},8,["href"])])):u("",!0)]}),_:1},8,["model","rules"])]),a("div",Te,[n(ee,{class:"flex-y-center"})])])],4)}}});export{qe as default};
