import{$ as l}from"./index-a553babf.js";import{f as v,r as i,o as h,u as g,d as C,e as _,v as S,a as b,E as f}from"./vendor-8484c245.js";const E=["src"],x=v({__name:"index",props:{bg:{default:"255,255,255"}},emits:["change"],setup(r,{emit:e}){const n=r,t=i();h(()=>{s()});const a=e,s=()=>{l.get("captcha/captchaCode",{params:{bg:n.bg,t:Date.now()}}).then(o=>{o.code===l.ResponseCode.SUCCESS&&(t.value=o.data.imag,a("change",o.data.token))})};return(o,d)=>g(t)?(C(),_("img",{key:0,src:g(t),title:"点击切换验证码",onClick:s,class:"pointer"},null,8,E)):S("",!0)}}),U=r=>{let e={url:"Sms/sendSMS",time:60,method:"POST",message:!0};e=Object.assign(e,r??{}),b(()=>{m()});const n=i("获取验证码"),t=i(!1);let a;const s=i(e.time),o=p=>{if(t.value)return;let c;e.method.toLocaleUpperCase()==="POST"?c=l.post(e.url,p):c=l.get(e.url,{params:p}),c==null||c.then(u=>{u.code===l.ResponseCode.SUCCESS?(f.success(u.msg),d()):f.info(u.msg)})},d=()=>{t.value=!0,a=setInterval(()=>{s.value--,s.value<=0?m():n.value=s.value+"s"},1e3)},m=()=>{a&&globalThis.clearInterval(a),a=void 0,t.value=!1,s.value=e.time,n.value="获取验证码"};return{isDisabled:t,vcodeText:n,getVcode:o,clear:m}};export{x as _,U as u};
