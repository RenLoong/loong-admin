import{_ as be}from"./copyright-44884c6e.js";import{f as F,r as M,V as me,aK as we,u as e,d as i,e as p,v as _,o as ze,a as Le,W as fe,A as s,x as r,B as W,w as u,t as E,G as D,aL as ge,K as ve,ab as he,aM as pe,ac as qe,C as Ee,T as Me,h as $,E as N,Y as Ie,R as Re,Q as Ve}from"./vendor-6d82558b.js";import{$ as C,s as Te,d as $e,e as Be,b as Se,c as Ue,h as Ne,r as _e}from"./index-f3cf2527.js";import{u as De,_ as Fe}from"./vcode-baed442b.js";const Qe=["src"],We=F({__name:"index",props:{text:{},size:{default:200}},emits:["update"],setup(B,{emit:R}){const m=B,l=R,h=M("");return me(()=>{h.value="",m.text&&we.toDataURL(m.text,{width:m.size},(I,d)=>{h.value=d,l("update")})}),(I,d)=>e(h)?(i(),p("img",{key:0,src:e(h),style:{width:"100%",height:"100%"}},null,8,Qe)):_("",!0)}}),Ae={class:"flex flex-column flex-y-center"},Ge={class:"text-white"},Ke={key:0,class:"h10 text-grey text-center mt-2"},Oe=F({__name:"index",props:{url:{},check:{},size:{default:200}},emits:["success"],setup(B,{emit:R}){const m=B,l=R,h=M({id:""}),I=M();ze(()=>{n()});let d;const x=M(),n=()=>{d&&(clearInterval(d),d=void 0),z.value=void 0,C.get(m.url).then(a=>{a.code===200?(h.value.id=a.data.id,I.value=a.data.qrcode,a.data.expire&&(x.value=a.data.expire,d=setInterval(()=>{x.value--,x.value||L("二维码已过期")},1e3))):L(a.msg)}).catch(()=>{L("获取二维码失败")})};let b;const c=C.axios.CancelToken;let k;const S=()=>{b&&(clearTimeout(b),k&&k.cancel("用户取消")),b=void 0,k=c.source(),C.post(m.check,h.value,{cancelToken:k.token}).then(a=>{k=void 0,a.code===C.ResponseCode.SUCCESS?l("success",a):a.code===C.ResponseCode.WAIT?b=setTimeout(()=>{S()},1e3):L(a.msg)}).catch(a=>{var V,q;a.code!="ERR_CANCELED"&&Te({code:a.code,msg:a.message,data:{method:(V=a.config)==null?void 0:V.method,url:(q=a.config)==null?void 0:q.url}})})},z=M(),L=a=>{d&&(clearInterval(d),d=void 0),x.value=void 0,z.value=a};return Le(()=>{b&&clearTimeout(b),d&&clearInterval(d),k&&k.cancel("用户取消")}),(a,V)=>{const q=We,U=fe("CircleClose"),t=ve,o=he;return i(),p("div",Ae,[s("div",{class:"qrcode",style:ge([`width:${m.size}px;height:${m.size}px;`])},[r(q,{text:e(I),size:Number(m.size),onUpdate:S},null,8,["text","size"]),s("div",{class:W(["error flex flex-column flex-center grid-gap-4",{show:e(z)}])},[r(t,{size:"40",color:"var(--el-color-danger)"},{default:u(()=>[r(U)]),_:1}),s("div",Ge,E(e(z)),1),r(o,{type:"primary",onClick:n,underline:!1},{default:u(()=>[D("点击重试")]),_:1})],2)],4),e(x)?(i(),p("div",Ke,"二维码将在"+E(e(x))+"秒后过期",1)):_("",!0)])}}});const Pe=$e(Oe,[["__scopeId","data-v-b58c8126"]]),Xe=s("div",{class:"login-bg"},null,-1),Ye={class:"login-mask"},je={class:"flex flex-1 flex-center"},He={key:0,class:"login-image mr-10"},Je=["src"],Ze=s("svg",{t:"1710471521992",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"4384","data-spm-anchor-id":"a313x.search_index.0.i0.68ec3a811kbX2r",width:"64",height:"64","xmlns:xlink":"http://www.w3.org/1999/xlink"},[s("path",{d:"M149.897707 387.566843l154.232099 0c49.484303 0 89.577425-40.093122 89.577425-89.577425L393.707231 143.757319C393.707231 94.273016 353.614109 54.179894 304.491005 54.179894L149.897707 54.179894c-49.484303 0-89.577425 40.093122-89.577425 89.577425l0 154.232099C60.320282 347.473721 100.774603 387.566843 149.897707 387.566843zM136.533333 143.757319c0-7.223986 6.140388-13.364374 13.364374-13.364374l154.232099 0c7.223986 0 13.364374 6.140388 13.364374 13.364374l0 154.232099c0 7.223986-6.140388 13.364374-13.364374 13.364374L149.897707 311.353792c-7.223986 0-13.364374-6.140388-13.364374-13.364374L136.533333 143.757319z","p-id":"4385"}),s("path",{d:"M304.491005 628.486772 149.897707 628.486772c-49.484303 0-89.577425 40.093122-89.577425 89.577425l0 154.232099c0 49.484303 40.093122 89.577425 89.577425 89.577425l154.232099 0c49.484303 0 89.577425-40.093122 89.577425-89.577425l0-154.232099C393.707231 668.579894 353.614109 628.486772 304.491005 628.486772zM317.49418 872.296296c0 7.223986-6.140388 13.364374-13.364374 13.364374L149.897707 885.66067c-7.223986 0-13.364374-6.140388-13.364374-13.364374l0-154.232099c0-7.223986 6.140388-13.364374 13.364374-13.364374l154.232099 0c7.223986 0 13.364374 6.140388 13.364374 13.364374L317.49418 872.296296z","p-id":"4386"}),s("path",{d:"M878.797884 54.179894l-154.232099 0c-49.484303 0-89.577425 40.093122-89.577425 89.577425l0 154.232099c0 49.484303 40.093122 89.577425 89.577425 89.577425l154.232099 0c49.484303 0 89.577425-40.093122 89.577425-89.577425L968.375309 143.757319C968.014109 94.273016 927.920988 54.179894 878.797884 54.179894zM891.801058 297.989418c0 7.223986-6.140388 13.364374-13.364374 13.364374l-154.232099 0c-7.223986 0-13.364374-6.140388-13.364374-13.364374L710.840212 143.757319c0-7.223986 6.140388-13.364374 13.364374-13.364374l154.232099 0c7.223986 0 13.364374 6.140388 13.364374 13.364374L891.801058 297.989418z","p-id":"4387"}),s("path",{d:"M673.997884 552.273721c19.865961 0 36.119929-15.892769 35.75873-36.119929 0-19.865961-15.892769-36.119929-36.119929-36.119929l-126.058554 0L547.578131 338.443739c0-19.865961-15.892769-36.119929-36.119929-35.75873-19.865961 0-36.119929 15.892769-36.119929 36.119929L475.338272 480.395062 96.440212 480.395062c-19.865961 0-36.119929 15.892769-36.119929 36.119929 0 19.865961 15.892769 36.119929 36.119929 36.119929l379.620459 0 0 169.04127c0 19.865961 15.892769 36.119929 36.119929 36.119929s36.119929-15.892769 36.119929-36.119929l0-169.04127L673.997884 552.634921z",fill:"var(--el-text-color-primary)","p-id":"4388"}),s("path",{d:"M932.255379 552.273721c19.865961 0 36.119929-15.892769 35.75873-36.119929 0-19.865961-15.892769-36.119929-36.119929-36.119929l-79.825044 0c-19.865961 0-36.119929 15.892769-36.119929 36.119929 0 19.865961 15.892769 36.119929 36.119929 36.119929L932.255379 552.273721z",fill:"var(--el-text-color-primary)","p-id":"4389"}),s("path",{d:"M511.8194 166.874074c19.865961 0 36.119929-15.892769 36.119929-36.119929L547.93933 88.855026c0-19.865961-15.892769-36.119929-36.119929-35.75873-19.865961 0-36.119929 15.892769-36.119929 36.119929l0 41.899118C476.06067 150.620106 491.953439 166.874074 511.8194 166.874074z",fill:"var(--el-text-color-primary)","p-id":"4390"}),s("path",{d:"M511.8194 849.179541c-19.865961 0-36.119929 15.892769-36.119929 36.119929l0 41.899118c0 19.865961 15.892769 36.119929 36.119929 36.119929s36.119929-15.892769 36.119929-36.119929l0-42.260317C547.93933 865.07231 531.685362 849.179541 511.8194 849.179541z",fill:"var(--el-text-color-primary)","p-id":"4391"}),s("path",{d:"M892.884656 871.573898c0 7.223986-6.140388 13.003175-13.003175 13.003175l-38.648325 0 0 75.129453 38.648325 0c48.761905 0 88.493827-39.731922 88.493827-88.493827l0-43.705115-75.129453 0L893.245855 871.573898z",fill:"var(--el-text-color-primary)","p-id":"4392"}),s("path",{d:"M879.520282 631.015168l-152.426102 0c-48.761905 0-88.493827 39.731922-88.493827 88.493827l0 152.426102c0 48.761905 39.731922 88.493827 88.493827 88.493827l38.648325 0L765.742504 884.938272l-38.648325 0c-7.223986 0-13.003175-6.140388-13.003175-13.003175l0-152.426102c0-7.223986 6.140388-13.003175 13.003175-13.003175l152.426102 0c7.223986 0 13.003175 6.140388 13.003175 13.003175l0 33.591534L968.014109 753.100529l0-33.591534C968.014109 670.74709 928.282187 631.015168 879.520282 631.015168z",fill:"var(--el-text-color-primary)","p-id":"4393"})],-1),e1={class:"text-center p-5"},l1={class:"flex flex-center pb-4"},o1={class:"h10 pt-3"},t1={key:1,class:"flex-1 flex flex-column"},s1={class:"flex-1 py-5 w-60 mx-auto flex flex-center flex-column"},a1={class:"px-3"},c1=s("div",{class:"p-4 flex flex-center mb-10"},[s("button",{class:"login-button"},"登录")],-1),n1={key:2,class:"flex-1"},i1={key:0,class:"h10 text-center mt-4 mb-10"},r1={key:3,class:"py-4 flex flex-center text-info"},d1={key:4,class:"py-4 flex flex-center text-dark"},u1=s("span",null,"点击“登录”即代表你已阅读并同意",-1),p1={class:"bg-filter bg-mask-light"},_1=F({name:"/login"}),h1=F({..._1,setup(B){var U;const{setUserInfo:R}=Be(),m=Se(),{WEBCONFIG:l}=Ue(m),{isDisabled:h,vcodeText:I,getVcode:d}=De(),x=M(),n=pe({username:"",password:"",vcode:"",token:"",captcha:""}),b=pe({username:[{required:!0,message:"请输入账号",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}],captcha:[{required:!0,message:"请输入图形验证码",trigger:"blur"}]}),c=M((U=l.value.login)==null?void 0:U.url);me(()=>{var t,o,y,w,f,g;(t=l.value.login)!=null&&t.url?c.value=(o=l.value.login)==null?void 0:o.url:(y=l.value.vcode)!=null&&y.url?c.value=(w=l.value.vcode)==null?void 0:w.url:(f=l.value.qrcode_login)!=null&&f.url&&(c.value=(g=l.value.qrcode_login)==null?void 0:g.url)});const k=()=>{var t;(t=x.value)==null||t.validate(o=>{o?C.post(c.value,n).then(y=>{q(y)}):N.error("请将表单填写完整")})},S=t=>{n.token=t,n.captcha=""},{BgImage:z,Image:L}=Ne(),a=qe(()=>{var o;let t="手机号/用户名";return c.value===((o=l.value.vcode)==null?void 0:o.url)&&(t="手机号"),t}),V=()=>{var t,o,y,w,f,g;c.value===((t=l.value.qrcode_login)==null?void 0:t.url)?(o=l.value.login)!=null&&o.url?c.value=(y=l.value.login)==null?void 0:y.url:(w=l.value.vcode)!=null&&w.url&&(c.value=(f=l.value.vcode)==null?void 0:f.url):c.value=(g=l.value.qrcode_login)==null?void 0:g.url},q=t=>{t.code===C.ResponseCode.SUCCESS?(N.success(t.msg),R(t.data).then(()=>{_e.push(_e.currentRoute.value.query.redirect??"/")}).catch(o=>{N.info(o)})):t.code===C.ResponseCode.REDIRECT_CONFIRM?Ie.confirm(t.msg,"提示",{confirmButtonText:t.data.confirmButtonText||"跳转",cancelButtonText:"取消",type:"warning"}).then(()=>{globalThis.location.href=t.data.url}):t.code===C.ResponseCode.REDIRECT?globalThis.location.href=t.data.url:N.info(t.msg)};return(t,o)=>{const y=fe("Monitor"),w=ve,f=Re,g=Ve,xe=Fe,Q=he,ke=Pe,ye=Me,Ce=be;return i(),p("div",{class:"login",style:ge([e(z)?`backgroundImage:url(${e(z)})`:""])},[Xe,s("div",Ye,[s("div",je,[e(L)?(i(),p("div",He,[s("img",{src:e(L),alt:"logo",class:"login-image"},null,8,Je)])):_("",!0),r(ye,{ref_key:"loginFormRef",ref:x,model:e(n),rules:e(b),class:"login-form bg-filter","label-position":"top","hide-required-asterisk":"","show-message":!1,onSubmit:Ee(k,["prevent"])},{default:u(()=>{var A,G,K,O,P,X,Y,j,H,J,Z,ee,le,oe,te,se,ae,ce,ne,ie,re,de,ue;return[(A=e(l).qrcode_login)!=null&&A.enable?(i(),p("div",{key:0,class:"qrcode-icon",onClick:V},[e(c)===((G=e(l).qrcode_login)==null?void 0:G.url)&&((K=e(l).login)!=null&&K.enable||(O=e(l).vcode)!=null&&O.enable)?(i(),$(w,{key:0,size:"20"},{default:u(()=>[r(y)]),_:1})):(i(),$(w,{key:1,size:"20",color:"var(--el-color-primary)"},{default:u(()=>[Ze]),_:1}))])):_("",!0),s("div",e1,[s("div",l1,[(P=e(l).login)!=null&&P.enable?(i(),p("div",{key:0,class:W(["h8 font-weight-600 mr-4 pointer nav-item",{active:e(c)===((X=e(l).login)==null?void 0:X.url)}]),onClick:o[0]||(o[0]=v=>{var T;return c.value=(T=e(l).login)==null?void 0:T.url})},E((Y=e(l).login)==null?void 0:Y.title),3)):_("",!0),(j=e(l).vcode)!=null&&j.enable?(i(),p("div",{key:1,class:W(["h8 font-weight-600 ml-4 pointer nav-item",{active:e(c)===((H=e(l).vcode)==null?void 0:H.url)}]),onClick:o[1]||(o[1]=v=>{var T;return c.value=(T=e(l).vcode)==null?void 0:T.url})},E((J=e(l).vcode)==null?void 0:J.title),3)):_("",!0)]),s("div",o1,E(e(l).web_title),1)]),e(c)!=((Z=e(l).qrcode_login)==null?void 0:Z.url)?(i(),p("div",t1,[s("div",s1,[r(g,{label:"账号",class:"w-100",prop:"username"},{default:u(()=>[r(f,{modelValue:e(n).username,"onUpdate:modelValue":o[2]||(o[2]=v=>e(n).username=v),placeholder:e(a),size:"large"},null,8,["modelValue","placeholder"])]),_:1}),e(c)===((ee=e(l).login)==null?void 0:ee.url)?(i(),$(g,{key:0,label:"密码",class:"w-100",prop:"password"},{default:u(()=>[r(f,{modelValue:e(n).password,"onUpdate:modelValue":o[3]||(o[3]=v=>e(n).password=v),type:"password",placeholder:"密码",size:"large"},null,8,["modelValue"])]),_:1})):_("",!0),e(c)===((le=e(l).vcode)==null?void 0:le.url)||e(c)===((oe=e(l).login)==null?void 0:oe.url)&&((te=e(l).login)!=null&&te.captcha)?(i(),$(g,{key:1,label:"图形验证码",class:"w-100",prop:"captcha"},{default:u(()=>[r(f,{modelValue:e(n).captcha,"onUpdate:modelValue":o[4]||(o[4]=v=>e(n).captcha=v),placeholder:"图形验证码",size:"large"},{append:u(()=>[r(xe,{onChange:S,bg:"52,52,52"})]),_:1},8,["modelValue"])]),_:1})):_("",!0),e(c)===((se=e(l).vcode)==null?void 0:se.url)?(i(),$(g,{key:2,label:"短信验证码",class:"w-100",prop:"vcode"},{default:u(()=>[r(f,{modelValue:e(n).vcode,"onUpdate:modelValue":o[6]||(o[6]=v=>e(n).vcode=v),placeholder:"短信验证码",size:"large",maxlength:"6"},{append:u(()=>[s("div",a1,[r(Q,{onClick:o[5]||(o[5]=v=>e(d)({username:e(n).username,token:e(n).token,captcha:e(n).captcha,scene:"login"})),type:e(h)?"info":"primary",target:"_blank",underline:!1,class:"line-height-5"},{default:u(()=>[D(E(e(I)),1)]),_:1},8,["type"])])]),_:1},8,["modelValue"])]),_:1})):_("",!0)]),c1])):(i(),p("div",n1,[r(ke,{url:(ae=e(l).qrcode_login)==null?void 0:ae.url,check:(ce=e(l).qrcode_login)==null?void 0:ce.check,onSuccess:q},null,8,["url","check"]),(ne=e(l).qrcode_login)!=null&&ne.title?(i(),p("div",i1,E((ie=e(l).qrcode_login)==null?void 0:ie.title),1)):_("",!0)])),(re=e(l).register)!=null&&re.enable?(i(),p("div",r1,[r(Q,{href:"#/register",type:"primary",underline:!1},{default:u(()=>[D("还没有账号？点击免费注册")]),_:1})])):_("",!0),(de=e(l).login)!=null&&de.user_agreement?(i(),p("div",d1,[u1,r(Q,{href:(ue=e(l).login)==null?void 0:ue.user_agreement,type:"primary",target:"_blank",underline:!1},{default:u(()=>[D("《用户协议》")]),_:1},8,["href"])])):_("",!0)]}),_:1},8,["model","rules"])]),s("div",p1,[r(Ce,{class:"flex-y-center"})])])],4)}}});export{h1 as default};
